---
title: Configuration
description: Complete configuration options for the Directus Nuxt module
---

## Module Options

### Full Configuration Example

```typescript
export default defineNuxtConfig({
    directus: {
        // Global middleware behavior
        enableGlobalMiddleware: true,

        // Authentication paths
        auth: {
            loginPath: "/auth/login",
            registerPath: "/auth/register",
            afterLoginPath: "/",
            afterLogoutPath: "/auth/login",
        },

        // TypeScript type generation
        types: {
            enabled: false,
            openApiUrl: "http://directus.local/server/specs/oas",
            output: "./schema/schema.d.ts",
            redoclyConfig: "./redocly.yaml",
            authHeaderEnv: "DIRECTUS_OPENAPI_TOKEN",
        },
    },
});
```

## Options Reference

### `enableGlobalMiddleware`

- **Type:** `boolean`
- **Default:** `true`

Controls the default authentication behavior for all routes.

**When `true`:**

- All routes require authentication by default
- Use `auth: false` in page meta to make pages public
- Login/register paths are automatically excluded

**When `false`:**

- All routes are public by default
- Use `auth: true` in page meta to protect specific pages

```typescript
// Example: Secure by default
directus: {
    enableGlobalMiddleware: true;
}

// In pages:
definePageMeta({ auth: false }); // Make page public
```

### `auth.loginPath`

- **Type:** `string`
- **Default:** `'/login'`

Path to the login page. This route is automatically:

- Excluded from authentication checks
- Treated as unauthenticated-only (authenticated users redirected)
- Used as redirect target for unauthenticated users

```typescript
auth: {
    loginPath: "/auth/login";
}
```

### `auth.registerPath`

- **Type:** `string`
- **Default:** `'/register'`

Path to the registration page. Behavior is identical to `loginPath`.

```typescript
auth: {
    registerPath: "/auth/register";
}
```

### `auth.afterLoginPath`

- **Type:** `string`
- **Default:** `'/'`

Where to redirect users after successful login. Can be overridden by:

1. Stored redirect cookie (from protected page access attempt)
2. Page meta `navigateAuthenticatedTo` property

```typescript
auth: {
    afterLoginPath: "/dashboard";
}
```

### `auth.afterLogoutPath`

- **Type:** `string`
- **Default:** `'/login'`

Where to redirect users after logout.

```typescript
auth: {
    afterLogoutPath: "/goodbye";
}
```

## Type Generation Options

### `types.enabled`

- **Type:** `boolean`
- **Default:** `false`

Enable automatic TypeScript type generation from Directus OpenAPI schema.

```typescript
types: {
    enabled: true;
}
```

### `types.openApiUrl`

- **Type:** `string`
- **Default:** `undefined`
- **Required when:** `types.enabled === true`

URL to your Directus OpenAPI schema endpoint.

```typescript
types: {
    openApiUrl: "http://directus.local/server/specs/oas";
}
```

### `types.output`

- **Type:** `string`
- **Default:** `'./schema/schema.d.ts'`

Output path for generated TypeScript types.

```typescript
types: {
    output: "./types/directus-schema.d.ts";
}
```

### `types.redoclyConfig`

- **Type:** `string`
- **Default:** `undefined`
- **Optional**

Path to Redocly configuration file for advanced OpenAPI processing.

```typescript
types: {
    redoclyConfig: "./redocly.yaml";
}
```

### `types.authHeaderEnv`

- **Type:** `string`
- **Default:** `'DIRECTUS_OPENAPI_TOKEN'`

Environment variable name containing the authorization token for OpenAPI endpoint access.

```typescript
types: {
    authHeaderEnv: "MY_DIRECTUS_TOKEN";
}
```

Set in `.env`:

```env
MY_DIRECTUS_TOKEN=Bearer your-token-here
```

## Environment Variables

### Required

```env
DIRECTUS_URL=http://localhost:8055
```

The base URL of your Directus instance.

**For production with proxy:**

```env
DIRECTUS_URL=/directus
```

### WebSocket URL (Optional)

```env
DIRECTUS_WS_URL=ws://localhost:8055
```

When using a proxy for regular Directus API requests, WebSocket connections cannot be proxied through Nitro's proxy system. In this case, you need to specify a direct WebSocket URL to your Directus instance.

**When to use:**

- ✅ You're proxying API requests through Nitro (`directusUrl: "/directus"`)
- ✅ Your Directus instance is on a different domain/port
- ✅ You need real-time features (WebSocket subscriptions)

**Configuration:**

```typescript
export default defineNuxtConfig({
    routeRules: {
        // Proxy REST API requests
        "/directus/**": {
            proxy: "http://localhost:8055/**",
        },
    },

    runtimeConfig: {
        public: {
            directusUrl: "/directus",  // Proxied REST API
            directusWsUrl: "http://localhost:8055",  // Direct WebSocket connection
        },
    },
});
```

```env
# .env
DIRECTUS_URL=/directus
DIRECTUS_WS_URL=http://localhost:8055
```

**Note:** The module automatically converts the HTTP protocol to WebSocket protocol (http → ws, https → wss) and appends `/websocket` to the URL.

If `directusWsUrl` is not provided, the module will use `directusUrl` for WebSocket connections (which works when not using a proxy).

### Optional (for type generation)

```env
DIRECTUS_OPENAPI_TOKEN=Bearer your-admin-token-here
DIRECTUS_OPENAPI_URL=http://directus.local/server/specs/oas
```

## Directus Server Configuration

### Authentication URL Allow Lists

These environment variables must be set on your **Directus server** (not your Nuxt app) to enable authentication features.

#### `PASSWORD_RESET_URL_ALLOW_LIST`

- **Required for:** Password reset functionality
- **Type:** Comma-separated list of URLs
- **Purpose:** Allows Directus to send password reset emails with links to your Nuxt app

```env
# Development
PASSWORD_RESET_URL_ALLOW_LIST=http://localhost:3000/auth/reset-password

# Production
PASSWORD_RESET_URL_ALLOW_LIST=https://your-app.com/auth/reset-password

# Multiple environments
PASSWORD_RESET_URL_ALLOW_LIST=http://localhost:3000/auth/reset-password,https://staging.your-app.com/auth/reset-password,https://your-app.com/auth/reset-password
```

The URL should match your `resetPasswordUrl` configuration or default to `/auth/reset-password`.

#### `USER_REGISTER_URL_ALLOW_LIST`

- **Required for:** Email verification after registration
- **Type:** Comma-separated list of URLs
- **Purpose:** Allows Directus to send verification emails with links to your Nuxt app

```env
# Development
USER_REGISTER_URL_ALLOW_LIST=http://localhost:3000/auth/verify-email

# Production
USER_REGISTER_URL_ALLOW_LIST=https://your-app.com/auth/verify-email
```

The URL should match your `verificationUrl` configuration or default to `/auth/verify-email`.

#### `USER_INVITE_URL_ALLOW_LIST`

- **Required for:** User invitation system
- **Type:** Comma-separated list of URLs
- **Purpose:** Allows Directus to send invitation emails with links to your Nuxt app
- **Optional:** Only needed if you're using user invitations

```env
# Development
USER_INVITE_URL_ALLOW_LIST=http://localhost:3000/auth/accept-invite

# Production
USER_INVITE_URL_ALLOW_LIST=https://your-app.com/auth/accept-invite
```

### Additional Directus Settings

#### Email Configuration

Ensure your Directus server has email properly configured:

```env
# Email transport
EMAIL_TRANSPORT=smtp
EMAIL_SMTP_HOST=smtp.example.com
EMAIL_SMTP_PORT=587
EMAIL_SMTP_USER=your-email@example.com
EMAIL_SMTP_PASSWORD=your-password
EMAIL_FROM=noreply@your-app.com
```

#### Public URL

Set the public URL for your Directus instance:

```env
PUBLIC_URL=https://directus.your-app.com
```

#### CORS (if not using proxy)

If you're connecting directly without a proxy:

```env
CORS_ENABLED=true
CORS_ORIGIN=http://localhost:3000,https://your-app.com
CORS_CREDENTIALS=true
CORS_METHODS=GET,POST,PATCH,DELETE,OPTIONS
CORS_ALLOWED_HEADERS=Content-Type,Authorization
```

**Note:** Using a proxy is recommended over CORS configuration. See [Proxy Configuration](#proxy-configuration) below.

### Complete Directus `.env` Example

```env
# Directus Server Configuration
PORT=8055
PUBLIC_URL=http://localhost:8055

# Database
DB_CLIENT=pg
DB_HOST=localhost
DB_PORT=5432
DB_DATABASE=directus
DB_USER=postgres
DB_PASSWORD=your-password

# Security
KEY=your-random-key
SECRET=your-random-secret

# Email
EMAIL_TRANSPORT=smtp
EMAIL_SMTP_HOST=smtp.example.com
EMAIL_SMTP_PORT=587
EMAIL_SMTP_USER=your-email@example.com
EMAIL_SMTP_PASSWORD=your-password
EMAIL_FROM=noreply@your-app.com

# Authentication URL Allow Lists (for Nuxt app)
PASSWORD_RESET_URL_ALLOW_LIST=http://localhost:3000/auth/reset-password,https://your-app.com/auth/reset-password
USER_REGISTER_URL_ALLOW_LIST=http://localhost:3000/auth/verify-email,https://your-app.com/auth/verify-email
USER_INVITE_URL_ALLOW_LIST=http://localhost:3000/auth/accept-invite,https://your-app.com/auth/accept-invite

# CORS (only if not using proxy)
# CORS_ENABLED=true
# CORS_ORIGIN=http://localhost:3000
# CORS_CREDENTIALS=true
```

## Proxy Configuration

### Why Use a Proxy?

When your Directus instance is on a different domain than your Nuxt app, use Nitro's proxy feature to:

- ✅ Avoid CORS configuration complexity
- ✅ Enable secure httpOnly cookies
- ✅ Simplify authentication flow
- ✅ Reduce security risks

**WebSocket Limitation:**

⚠️ WebSocket connections cannot be proxied through Nitro. When using a proxy for REST API requests, you must configure `directusWsUrl` to point directly to your Directus instance for real-time features to work.

### Basic Proxy Setup

```typescript
export default defineNuxtConfig({
    modules: ["@michael-nussbaumer/nuxt-directus"],

    routeRules: {
        // Proxy all Directus requests
        "/directus/**": {
            proxy: "http://directus.example.com/**",
        },
    },

    runtimeConfig: {
        public: {
            directusUrl: "/directus",  // Proxied REST API
            directusWsUrl: "http://directus.example.com",  // Direct WebSocket
        },
    },
});
```

```env
# .env
DIRECTUS_URL=/directus
DIRECTUS_WS_URL=http://directus.example.com
```

### Environment-Specific Proxy

```typescript
export default defineNuxtConfig({
    routeRules: {
        "/directus/**": {
            proxy: process.env.NODE_ENV === "production" ? "https://directus.example.com/**" : "http://localhost:8055/**",
        },
    },

    runtimeConfig: {
        public: {
            directusUrl: process.env.NUXT_PUBLIC_DIRECTUS_URL || "/directus",
            directusWsUrl: process.env.NUXT_PUBLIC_DIRECTUS_WS_URL,
        },
    },
});
```

```env
# .env.development
DIRECTUS_URL=/directus
DIRECTUS_WS_URL=http://localhost:8055

# .env.production
DIRECTUS_URL=/directus
DIRECTUS_WS_URL=https://directus.example.com
```

### Advanced Proxy with Headers

```typescript
export default defineNuxtConfig({
    routeRules: {
        "/directus/**": {
            proxy: {
                to: "http://directus.example.com/**",
                // Forward original host and protocol
                headers: {
                    "X-Forwarded-Host": (req) => req.headers.host,
                    "X-Forwarded-Proto": process.env.NODE_ENV === "production" ? "https" : "http",
                },
            },
        },
    },
});
```

### Direct Connection (Not Recommended)

If you cannot use a proxy, configure Directus CORS:

**On Directus server (`.env`):**

```env
CORS_ENABLED=true
CORS_ORIGIN=https://your-nuxt-app.com,http://localhost:3000
CORS_CREDENTIALS=true
CORS_METHODS=GET,POST,PATCH,DELETE,OPTIONS
CORS_ALLOWED_HEADERS=Content-Type,Authorization
```

**Security considerations:**

- httpOnly cookies cannot be used (less secure)
- sameSite must be 'none' (CSRF risk)
- Requires HTTPS in production
- More complex to maintain

⚠️ **Always prefer proxy configuration for production deployments.**

## Common Configurations

### Development Setup

```typescript
export default defineNuxtConfig({
    directus: {
        enableGlobalMiddleware: false, // Public by default for easier dev
        auth: {
            loginPath: "/auth/login",
            registerPath: "/auth/register",
            afterLoginPath: "/dashboard",
            afterLogoutPath: "/auth/login",
        },
        types: {
            enabled: true, // Generate types during development
            openApiUrl: "http://localhost:8055/server/specs/oas",
            output: "./schema/schema.d.ts",
        },
    },

    // Local Directus - no proxy needed
    runtimeConfig: {
        public: {
            directusUrl: "http://localhost:8055",
        },
    },
});
```

### Production Setup

```typescript
export default defineNuxtConfig({
    directus: {
        enableGlobalMiddleware: true, // Secure by default
        auth: {
            loginPath: "/auth/login",
            registerPath: "/auth/register",
            afterLoginPath: "/app",
            afterLogoutPath: "/",
        },
        types: {
            enabled: false, // Types already generated
        },
    },

    // Proxy Directus through Nuxt server
    routeRules: {
        "/directus/**": {
            proxy: "https://directus.example.com/**",
        },
    },

    runtimeConfig: {
        public: {
            directusUrl: "/directus",  // Proxied REST API
            directusWsUrl: "https://directus.example.com",  // Direct WebSocket
        },
    },
});
```

```env
# .env.production
DIRECTUS_URL=/directus
DIRECTUS_WS_URL=https://directus.example.com
```

### Multi-tenant Setup

```typescript
export default defineNuxtConfig({
    directus: {
        enableGlobalMiddleware: true,
        auth: {
            loginPath: "/tenant/login",
            registerPath: "/tenant/register",
            afterLoginPath: "/tenant/dashboard",
            afterLogoutPath: "/tenant/login",
        },
    },
});
```
